<div class="mb-6">
  <button
    type="button"
    class="inline-flex items-center gap-2  rounded-lg px-4 py-2 text-purple-700 text-sm font-bold shadow transition hover:shadow-md bg-gray-200"
    [ngClass]="isEditMode ? 'from-amber-400 to-orange-500' : (showForm ? 'from-rose-500 to-red-600' : 'from-indigo-500 to-purple-500')"
    (click)="toggleForm()">
    <span *ngIf="!showForm && !isEditMode" >Create New Task</span>
    <span *ngIf="showForm && !isEditMode">✕ Cancel</span>
    <span *ngIf="isEditMode">✕ Cancel Edit</span>
  </button>
  <div class="mt-4 rounded-xl bg-white p-6 shadow" *ngIf="showForm">
    <h3 class="mb-4 text-lg font-semibold text-slate-800">
      {{ isEditMode ? 'Edit Task' : 'Create New Task' }}
    </h3>

    <div *ngIf="successMessage" class="mb-4 rounded-md border border-emerald-200 bg-emerald-50 px-4 py-3 text-sm text-emerald-800">
      {{ successMessage }}
    </div>

    <div *ngIf="errorMessage" class="mb-4 rounded-md border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-800">
      {{ errorMessage }}
    </div>

    <!-- Form -->
    <form [formGroup]="taskForm" (ngSubmit)="onSubmit()" class="space-y-5">
      <!-- Title Field -->
      <div>
        <label for="title" class="text-sm font-semibold text-slate-700">
          Title <span class="text-rose-500">*</span>
        </label>
        <input
          type="text"
          id="title"
          formControlName="title"
          placeholder="Enter task title"
          class="mt-2 w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-800 transition focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-200"
          [ngClass]="{ 'border-rose-500 focus:border-rose-500 focus:ring-rose-200': isFieldInvalid('title') }">
        <div class="mt-1 text-xs text-rose-600" *ngIf="isFieldInvalid('title')">
          {{ getFieldError('title') }}
        </div>
      </div>

      <!-- Description Field -->
      <div>
        <label for="description" class="text-sm font-semibold text-slate-700">
          Description
        </label>
        <textarea
          id="description"
          formControlName="description"
          rows="4"
          placeholder="Enter task description (optional)"
          class="mt-2 w-full resize-y rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-800 transition focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-200"
          [ngClass]="{ 'border-rose-500 focus:border-rose-500 focus:ring-rose-200': isFieldInvalid('description') }"></textarea>
        <div class="mt-1 text-xs text-rose-600" *ngIf="isFieldInvalid('description')">
          {{ getFieldError('description') }}
        </div>
      </div>

      <!-- Form Actions -->
      <div class="flex items-center justify-end gap-3">
        <button
          type="button"
          class="rounded-md bg-slate-200 px-4 py-2 text-sm font-semibold text-slate-700 transition hover:bg-slate-300 disabled:cursor-not-allowed disabled:opacity-60"
          (click)="isEditMode ? cancelEdit() : setFormVisible(false)"
          [disabled]="isSubmitting">
          Cancel
        </button>
        <button
          type="submit"
          class="rounded-md from-indigo-500 to-purple-500 px-4 py-2 text-sm font-semibold text-purple-700 shadow transition hover:shadow-md disabled:cursor-not-allowed disabled:opacity-60"
          [disabled]="isSubmitting">
          <span *ngIf="!isSubmitting && !isEditMode">Create Task</span>
          <span *ngIf="!isSubmitting && isEditMode">Update Task</span>
          <span *ngIf="isSubmitting && !isEditMode">Creating...</span>
          <span *ngIf="isSubmitting && isEditMode">Updating...</span>
        </button>
      </div>
    </form>
  </div>
</div>
